(this["webpackJsonptaylor-webapp"]=this["webpackJsonptaylor-webapp"]||[]).push([[1],{460:function(e,t,n){e.exports=n(814)},465:function(e,t,n){},466:function(e,t,n){},814:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),o=n(161),s=n.n(o),i=(n(465),n(466),n(50)),c=n.n(i),u=n(92),l=n(90),d=n(72),h=n(73),f=n(27),p=n(84),m=n(85),b=n(162),g=n(171),v=n(81),w=n(457),y=n.n(w),x={selectOnLineNumbers:!0,minimap:{enabled:!1},wordWrap:"on",wordWrapColumn:80,fontSize:18,lineNumbersMinChars:2,lineDecorationsWidth:0},k=n(341),C=function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=9;break}return e.prev=1,e.next=4,ethereum.enable();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("User rejected dApp connection");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(u.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:if(!window.web3||!window.web3.currentProvider){e.next=6;break}return t=new k.ethers.providers.Web3Provider(web3.currentProvider),n=t.getSigner(0),e.abrupt("return",{provider:t,signer:n});case 6:return e.abrupt("return",{});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j={5777:{contract1:"0x04d37378feb94dee3f6a07c1feb3ca630149d6d5",root:"contract1"},3:{contract1:"0xc6743db47ce3702599820282940c3561b2269556",root:"contract1"},42:{contract1:"0xee0c10d568c9772892aab27c3fc14d7033658833",root:"contract1"},4:{contract1:"0x19c08c750420af47059e68888b0f6a32698d0928",root:"contract1"},5:{contract1:"0x5d6aa1a248655f76917bb97a7fef24dd40aa2b6d",root:"contract1"}},O={5777:0,3:8036099,42:18899976,4:6616106,5:2823431},S=function(e){return"TaylorInterpreterAddress_"+e},A=function(e,t,n){var r=S(e),a=R(e);a[n]=t,a.root=n,localStorage.setItem(r,JSON.stringify(a))},R=function(e){var t,n=S(e);return t=j[e]||{},localStorage.setItem(n,JSON.stringify(t)),t},T=n(179),I=n.n(T),z=function(e){return function(t){return function(){var n=Object(u.a)(c.a.mark((function n(r){var a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={address:t,topics:[r],fromBlock:O[e._network.chainId]||0,toBlock:"latest"},n.abrupt("return",e.getLogs(a));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},W=function(e){return function(t){return function(){var n=Object(u.a)(c.a.mark((function n(r){var a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={to:t,data:r},n.next=3,e.call(a);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},N=function(e){return function(t){return function(){var n=Object(u.a)(c.a.mark((function n(r){var a,o;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={data:r,gasLimit:1e6,value:0,to:t,gasPrice:21},n.next=3,e.sendTransaction(a);case 3:return o=n.sent,n.abrupt("return",o);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},P=function(e,t){return function(n){return{call:W(e)(n),send:N(t)(n),getLogs:z(e)(n),getFns:(r=z(e)(n),Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,r("0x00000000000000000000000000000000000000000000000000000000ffffffff");case 3:return t=e.sent,e.abrupt("return",t.map((function(e){return e.name=e.topics[1].substring(2).hexDecode(),e.signature="0x"+e.topics[2].substring(58),e})));case 5:case"end":return e.stop()}}),e)}))))};var r}},B=n(148),F={uint:12,bool:!0,address:'0x"0000000000000000000000000000000000000000"',bytes:'0x"00"',symbol:"name",list:"12 13",any:"somename"},D=function(e){var t;return t=e.inputs?e.inputs.map((function(e){return e.type})).join(" "):Object(B.a)(new Array(e.arity||0)).map((function(e,t){return"arg_"+t})).join(" "),e.arity||(t="a b ..."),t},L={color:"beige",fontSize:x.fontSize,fontFamily:"monospace"},M={backgroundColor:"rgb(169, 169, 169)"},V={marginLeft:"10px",marginRight:"10px"},_=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={provider:null,signer:null,rootAddress:{},addresses:{},rootFunctions:[],addrToBeRegistered:null,registered:{}},r.onChangeAddress=r.onChangeAddress.bind(Object(f.a)(r)),r.onChangeCurrentName=r.onChangeCurrentName.bind(Object(f.a)(r)),r.onAddressSave=r.onAddressSave.bind(Object(f.a)(r)),r.onChangeRootAddress=r.onChangeRootAddress.bind(Object(f.a)(r)),r.onChangeRegisteredAddress=r.onChangeRegisteredAddress.bind(Object(f.a)(r)),r.onRegister=r.onRegister.bind(Object(f.a)(r)),r.setWeb3(),r}return Object(h.a)(n,[{key:"setWeb3",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,r,a,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:if(t=e.sent,n=t.provider,r=t.signer,n){e.next=8;break}return this.props.onRootChange(null,null),e.abrupt("return");case 8:return e.next=10,n.getNetwork();case 10:a=e.sent.chainId,o=R(a),s={name:o.root,address:o[o.root]},this.setState({addresses:o,rootAddress:s,provider:n,signer:r}),this._web3util=P(n,r),this.setContract(s.address),this.setRegistered(s.address);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setContract",value:function(e){(e=e||this.state.rootAddress)?(this.web3util=this._web3util(e),this.props.onRootChange(this.web3util.call,this.web3util.send),this.setFunctions(e)):this.web3util=null}},{key:"setRegistered",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var n,r,a,o,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=t||this.state.rootAddress.address){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.web3util.call("0x44444440");case 5:n=e.sent,n=parseInt(n,16),r={},a=1;case 9:if(!(a<=n)){e.next=19;break}return o=I.a.expr2h("(getregistered "+a+")"),e.next=13,this.web3util.call(o);case 13:s="0x"+(s=e.sent).substring(10),r[s]=s;case 16:a++,e.next=9;break;case 19:this.setState({registered:r});case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setFunctions",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=t||this.state.rootAddress.address){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.web3util.getFns();case 5:n=e.sent,r=n.map((function(e){return"("+e.name+" ... )"})).concat(Object.keys(I.a.nativeEnv).map((function(e){return"("+e+" "+D(I.a.nativeEnv[e])+")"}))),this.setState({rootFunctions:r});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeAddress",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.state.rootAddress).address=t,this.setState({rootAddress:n});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeCurrentName",value:function(e){var t=this.state.rootAddress;t.name=e,this.setState({rootAddress:t})}},{key:"onAddressSave",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.rootAddress,n=this.state.provider,e.next=4,n.getNetwork();case 4:r=e.sent.chainId,A(r,t.address,t.name),this.setContract(t.address),this.setRegistered(t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onChangeRootAddress",value:function(e){var t=this.state.addresses,n=Object.keys(t).find((function(n){return t[n]===e}))||e,r={name:n,address:e};t[n]||(t[n]=e,this.setState({addresses:t})),this.setState({rootAddress:r}),this.setContract(r.address),this.setRegistered(e)}},{key:"onChangeRegisteredAddress",value:function(e){this.setState({addrToBeRegistered:e})}},{key:"onRegister",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.addrToBeRegistered,n=I.a.expr2h('(register! 0x"'+t.substring(2)+'")'),e.next=4,this.web3util.send(n);case 4:this.setRegistered();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.styles;e.width-=10;var t=this.state,n=t.rootAddress,r=t.addresses,o=t.registered,s=t.rootFunctions,i=Object.assign({},r);delete i.root;var c=Object.keys(i).map((function(e){return a.a.createElement(v.Picker.Item,{label:e,value:r[e],key:e})}));return a.a.createElement(v.View,{style:Object(l.a)({},e,{flex:1})},a.a.createElement(v.Button,{small:!0,light:!0,style:{position:"fixed",top:"10px",right:"30px"},onClick:function(){return window.open("https://github.com/loredanacirstea/taylor","_blank")}},a.a.createElement(v.Icon,{name:"info",type:"FontAwesome",style:V})),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(v.Text,{style:L},"select root Taylor contract:"),a.a.createElement(v.Item,{picker:!0,style:{borderColor:!1}},a.a.createElement(v.Picker,{mode:"dropdown",style:Object(l.a)({width:e.width},M),selectedValue:this.state.rootAddress.name,onValueChange:this.onChangeRootAddress},c)),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(v.Text,{style:L},"@root address:"),a.a.createElement(v.Text,{style:Object(l.a)({},L,{fontWeight:"bold",fontSize:L.fontSize+2})},n.address||"-"),a.a.createElement("br",null),a.a.createElement(v.Text,{style:L},"registered contracts @root:"),a.a.createElement(v.Item,{picker:!0,style:{borderColor:!1}},a.a.createElement(v.Picker,{mode:"dropdown",style:Object(l.a)({width:e.width},M),selectedValue:this.state.rootAddress.name,onValueChange:this.onChangeRootAddress},a.a.createElement(v.Picker.Item,{label:"...",value:""}),Object.keys(o).map((function(e){return a.a.createElement(v.Picker.Item,{label:e,value:r[e],key:e})})))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(v.Text,{style:L},"@root functions:"),a.a.createElement(v.Item,{picker:!0,style:{borderColor:!1}},a.a.createElement(v.Picker,{mode:"dropdown",style:Object(l.a)({width:e.width},M)},a.a.createElement(v.Picker.Item,{label:"...",value:""}),s.map((function(e,t){return a.a.createElement(v.Picker.Item,{label:e,value:e,key:t})})))),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(v.Text,{style:L},"register a Taylor contract @root:"),a.a.createElement(v.Item,{style:{width:e.width}},a.a.createElement(v.Input,{style:L,placeholder:"address",label:"address",onChangeText:this.onChangeRegisteredAddress}),a.a.createElement(v.Button,{small:!0,light:!0,onClick:this.onRegister},a.a.createElement(v.Icon,{name:"save",style:V}))),a.a.createElement("br",null),a.a.createElement("br",null))}}]),n}(r.Component),H=n(458),J=n.n(H),U=function(e){Object(m.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(d.a)(this,n),r=t.call(this,e);var a=function(){var e=window.localStorage.getItem("TaylorCode");return e||(e="(add (mul 2 (add 13 56)) 9000)",window.localStorage.setItem("TaylorCode",e)),e}(),o=I.a.expr2h(a);return r.state=Object(l.a)({},r.getWindowDimensions(),{pageNumber:3,code:a,encoded:o,result:[{data:o}],errors:"",rootAddress:null,taycall:null,taysend:null}),r.onContentSizeChange=r.onContentSizeChange.bind(Object(f.a)(r)),r.getWindowDimensions=r.getWindowDimensions.bind(Object(f.a)(r)),r.onTextChange=r.onTextChange.bind(Object(f.a)(r)),r.execute=r.execute.bind(Object(f.a)(r)),r.onRootChange=r.onRootChange.bind(Object(f.a)(r)),b.a.addEventListener("change",(function(){r.onContentSizeChange()})),r}return Object(h.a)(n,[{key:"onRootChange",value:function(e,t){if(this.setState({taycall:e,taysend:t}),e)this.execute();else{this.setState({errors:"No web3 provider found. Please connect to one (e.g. Metamask)."})}}},{key:"execute",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,n,r,a,o,s,i,u,l,d=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>0&&void 0!==d[0]?d[0]:{},n=t.encdata,r=t.code,a=t.force,o=void 0!==a&&a,n=n||this.state.encoded,r=r||this.state.code,r&&r.includes("!")){e.next=17;break}return e.prev=5,e.next=8,this.state.taycall(n);case 8:s=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:try{i=I.a.decode(s)}catch(c){}this.setState({result:[{result:i,encoded:s,data:n}]}),e.next=35;break;case 17:if(!o){e.next=35;break}return l={},e.prev=19,e.next=22,this.state.taysend(n);case 22:return u=e.sent,this.setState({result:[{receipt:u}]}),e.next=26,u.wait();case 26:l=e.sent,e.next=32;break;case 29:e.prev=29,e.t1=e.catch(19),console.log(e.t1);case 32:if(0!==l.status){e.next=34;break}throw new Error("Transaction failed");case 34:this.setState({result:[{receipt:l}]});case 35:case"end":return e.stop()}}),e,this,[[5,11],[19,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"onContentSizeChange",value:function(){this.setState(this.getWindowDimensions())}},{key:"getWindowDimensions",value:function(){var e=b.a.get("window"),t=document.getElementById("TaylorRoot").getBoundingClientRect();return{width:e.width||t.width,height:e.height||t.height}}},{key:"editorDidMount",value:function(e,t){e.focus()}},{key:"editorWillMount",value:function(e){!function(e,t){e.languages.register({id:"taylor"});var n=function(n){return Object.keys(t).map((function(r){var a=t[r],o=D(a),s=a.construct;return s||(s=r,a.inputs&&(s+=" "+a.inputs.map((function(e){return F[e.type]})).join(" "))),{label:r,kind:e.languages.CompletionItemKind.Function,insertText:s+")",detail:"("+o+")",documentation:a.docs,range:n}}))};e.languages.registerCompletionItemProvider("taylor",{triggerCharacters:["("],provideCompletionItems:function(e,t){var r=e.getWordUntilPosition(t),a={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:r.startColumn,endColumn:r.endColumn};return{suggestions:n(a)}}})}(e,I.a.nativeEnv)}},{key:"onTextChange",value:function(e){try{var t=I.a.expr2h(e);this.setState({code:e}),n=e,window.localStorage.setItem("TaylorCode",n),this.execute({encdata:t,code:e})}catch(r){}var n}},{key:"render",value:function(){var e,t,n,r=this,o=this.state,s=o.width,i=o.height;if(s>800){var c=s/3;t={width:2*c,height:i-(e={width:2*c,height:2*i/3}).height},n={width:c,height:i}}else t={width:s,height:i-(e={width:s,height:2*i/3}).height},n={width:s,height:i};var u=this.state,d=u.code,h=u.result,f=u.errors,p=u.taycall,m=u.taysend;return a.a.createElement(g.a,{horizontal:!0,pagingEnabled:!0,scrollEnabled:!0,scrollEventThrottle:100,nestedScrollEnabled:!0,contentContainerStyle:{width:"100%"},onContentSizeChange:this.onContentSizeChange},a.a.createElement(y.a,{width:e.width,height:e.height,language:"taylor",theme:"vs-dark",value:d,options:x,onChange:this.onTextChange,editorWillMount:this.editorWillMount,editorDidMount:this.editorDidMount}),a.a.createElement(v.View,{style:Object(l.a)({},t,{position:"fixed",bottom:"0px",left:"0px"})},a.a.createElement(g.a,{horizontal:!1,scrollEnabled:!0,scrollEventThrottle:100,nestedScrollEnabled:!0,contentContainerStyle:Object(l.a)({},t,{maxHeight:t.height,minHeight:t.heigth})},a.a.createElement(g.a,{horizontal:!0,scrollEnabled:!0,scrollEventThrottle:100,contentContainerStyle:Object(l.a)({},t,{maxHeight:t.height,minHeight:t.heigth})},f?a.a.createElement(v.Text,{style:{color:"firebrick",fontSize:x.fontSize}},f):a.a.createElement(J.a,{src:h,name:"result",theme:"twilight",collapsed:6,shouldCollapse:function(e){return"d"===e.name},style:Object(l.a)({},t,{fontSize:x.fontSize})})))),a.a.createElement(v.Button,{small:!0,light:!0,style:{position:"fixed",top:"0px",left:"0px",backgroundColor:"white",opacity:.5},onClick:function(){return r.execute({force:!0})}},a.a.createElement(v.Icon,{style:{marginLeft:"10px",marginRight:"10px"},type:"FontAwesome",name:"play"})),a.a.createElement(g.a,{horizontal:!1,scrollEnabled:!0,scrollEventThrottle:100,nestedScrollEnabled:!0,contentContainerStyle:n},a.a.createElement(_,{taycall:p,taysend:m,styles:Object(l.a)({},n),onRootChange:this.onRootChange})))}}]),n}(r.Component);var K=function(e){return a.a.createElement(U,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(a.a.createElement(K,null),document.getElementById("TaylorRoot")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[460,2,3]]]);
//# sourceMappingURL=main.58abb365.chunk.js.map