(this["webpackJsonptaylor-webapp"]=this["webpackJsonptaylor-webapp"]||[]).push([[0],{458:function(e,t,n){e.exports=n(751)},463:function(e,t,n){},464:function(e,t,n){},751:function(e,t,n){"use strict";n.r(t);var r=n(9),a=n.n(r),s=n(159),o=n.n(s),i=(n(463),n(464),n(52)),c=n.n(i),l=n(97),d=n(82),u=n(71),h=n(72),g=n(26),p=n(84),f=n(85),m=n(160),b=n(170),v=n(74),w=n(455),y=n.n(w),x={selectOnLineNumbers:!0,minimap:{enabled:!1},wordWrap:"on",wordWrapColumn:80,fontSize:14},C=n(456),k=n.n(C);var E=function(e){var t=e.styles,n=e.result,r=e.errors,s=x.fontSize;return a.a.createElement(b.a,{horizontal:!1,scrollEnabled:!0,scrollEventThrottle:100,nestedScrollEnabled:!0,contentContainerStyle:{width:t.width},style:Object(d.a)({},t,{flex:1})},a.a.createElement(b.a,{horizontal:!0,scrollEnabled:!0,scrollEventThrottle:100,contentContainerStyle:{width:t.width},style:Object(d.a)({},t,{flex:1})},r?a.a.createElement(v.Text,{style:{color:"firebrick",fontSize:s}},r):a.a.createElement(k.a,{src:n,name:"result",theme:"twilight",collapsed:6,shouldCollapse:function(e){return"d"===e.name},style:{fontSize:s}})))},O=n(457),j=function(){var e=Object(l.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=10;break}return t=new Web3(ethereum),e.prev=2,e.next=5,ethereum.enable();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),console.log("User rejected dApp connection");case 10:if(!t&&window.web3&&(t=new Web3(web3.currentProvider)),t){e.next=14;break}return console.log("Non-Ethereum browser detected. Consider trying MetaMask!"),e.abrupt("return",null);case 14:return e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:return t=e.sent,n=new O.ethers.providers.Web3Provider(t.currentProvider),r=n.getSigner(0),e.abrupt("return",{provider:n,signer:r});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A={5777:{contract1:"0xCFF8dc8A5e2Af7fcc6BE124d3C91FA50186A8c96",root:"contract1"},3:{contract1:"0x7D4150f492f93e2eDD7FC0Fc62c9193b322f75e5",root:"contract1"}},R=function(e){return"TaylorInterpreterAddress_"+e},T=function(e,t,n){var r=R(e),a=I(e);a[n]=t,a.root=n,localStorage.setItem(r,JSON.stringify(a))},I=function(e){var t=R(e),n=localStorage.getItem(t);return n?n=JSON.parse(n):(n=A[e]||{},localStorage.setItem(t,JSON.stringify(n))),n},W=n(213),z=n.n(W),N=function(e){return function(t){return function(){var n=Object(l.a)(c.a.mark((function n(r){var a;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={to:t,data:r},n.next=3,e.call(a);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},B=function(e){return function(t){return function(){var n=Object(l.a)(c.a.mark((function n(r){var a,s;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a={data:r,gasLimit:1e6,value:0,to:t,gasPrice:21},n.next=3,e.sendTransaction(a);case 3:return s=n.sent,n.abrupt("return",s);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},D=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={provider:null,signer:null,rootAddress:{},addresses:{},rootFunctions:[],addrToBeRegistered:null,registered:{}},r.onChangeAddress=r.onChangeAddress.bind(Object(g.a)(r)),r.onChangeCurrentName=r.onChangeCurrentName.bind(Object(g.a)(r)),r.onAddressSave=r.onAddressSave.bind(Object(g.a)(r)),r.onChangeRootAddress=r.onChangeRootAddress.bind(Object(g.a)(r)),r.onChangeRegisteredAddress=r.onChangeRegisteredAddress.bind(Object(g.a)(r)),r.onRegister=r.onRegister.bind(Object(g.a)(r)),r.setWeb3(),r}return Object(h.a)(n,[{key:"setWeb3",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r,a,s,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:return t=e.sent,n=t.provider,r=t.signer,e.next=7,n.getNetwork();case 7:a=e.sent.chainId,s=I(a),o={name:s.root,address:s[s.root]},this.setState({addresses:s,rootAddress:o,provider:n,signer:r}),this._taycall=N(n),this._taysend=B(r),this.setContract(o.address),this.setRegistered(o.address);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setContract",value:function(e){(e=e||this.state.rootAddress)?(this.taycall=this._taycall(e),this.taysend=this._taysend(e),this.props.onRootChange(this.taycall,this.taysend)):(this.taycall=null,this.taysend=null)}},{key:"setRegistered",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n,r,a,s,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=t||this.state.rootAddress.address){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.taycall("0x44444440");case 5:n=e.sent,n=parseInt(n,16),r={},a=1;case 9:if(!(a<=n)){e.next=19;break}return s=z.a.expr2h("(getregistered "+a+")"),e.next=13,this.props.taycall(s);case 13:o="0x"+(o=e.sent).substring(10),r[o]=o;case 16:a++,e.next=9;break;case 19:this.setState({registered:r});case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeAddress",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.state.rootAddress).address=t,this.setState({rootAddress:n});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeCurrentName",value:function(e){var t=this.state.rootAddress;t.name=e,this.setState({rootAddress:t})}},{key:"onAddressSave",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.rootAddress,n=this.state.provider,e.next=4,n.getNetwork();case 4:r=e.sent.chainId,T(r,t.address,t.name),this.setContract(t.address),this.setRegistered(t);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onChangeRootAddress",value:function(e){var t=this.state.addresses,n={name:Object.keys(t).find((function(n){return t[n]===e})),address:e};this.setState({rootAddress:n}),this.setContract(n.address),this.setRegistered(e)}},{key:"onChangeRegisteredAddress",value:function(e){this.setState({addrToBeRegistered:e})}},{key:"onRegister",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.addrToBeRegistered,n=z.a.expr2h('(register! 0x"'+t.substring(2)+'")'),e.next=4,this.taysend(n);case 4:this.setRegistered();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.styles,t=this.state,n=t.rootAddress,r=t.addresses,s=t.registered;return a.a.createElement(v.View,{style:Object(d.a)({},e,{fontSize:18})},a.a.createElement(v.View,{style:Object(d.a)({},e,{flex:1})},a.a.createElement(v.Item,{style:{width:e.width}},a.a.createElement(v.Input,{style:{color:"white"},placeholder:"address",label:"address",onChangeText:this.onChangeAddress})),a.a.createElement(v.Item,{style:{width:e.width}},a.a.createElement(v.Input,{style:{color:"white"},placeholder:"name",label:"name",onChangeText:this.onChangeCurrentName})),a.a.createElement(v.Button,{small:!0,light:!0,onClick:this.onAddressSave},a.a.createElement(v.Icon,{name:"save"}))),a.a.createElement(v.View,{style:Object(d.a)({},e,{flex:1})},a.a.createElement(v.Item,{picker:!0},a.a.createElement(v.Picker,{mode:"dropdown",style:{width:e.width,backgroundColor:"rgb(169, 169, 169)"},selectedValue:this.state.rootAddress.name,onValueChange:this.onChangeRootAddress},a.a.createElement(v.Picker.Item,{label:"select root",value:""}),Object.keys(r).map((function(e){return a.a.createElement(v.Picker.Item,{label:e,value:r[e],key:e})})))),a.a.createElement(v.View,{style:{width:e.width,flex:1,paddingTop:10}},a.a.createElement(v.Text,{style:{color:"beige",fontSize:18}},"Root Contract"),a.a.createElement("br",null),a.a.createElement(v.Text,{style:{color:"beige",fontSize:18}},n.name||"-"," - ",n.address||"-")),a.a.createElement(v.Item,{picker:!0},a.a.createElement(v.Picker,{mode:"dropdown",style:{width:e.width,backgroundColor:"rgb(169, 169, 169)"},selectedValue:this.state.rootAddress.name,onValueChange:this.onChangeRootAddress},a.a.createElement(v.Picker.Item,{label:"select registered contract",value:""}),Object.keys(s).map((function(e){return a.a.createElement(v.Picker.Item,{label:e,value:r[e],key:e})})))),a.a.createElement(v.Item,{style:{width:e.width}},a.a.createElement(v.Input,{style:{color:"white"},placeholder:"address",label:"address",onChangeText:this.onChangeRegisteredAddress})),a.a.createElement(v.Button,{small:!0,light:!0,onClick:this.onRegister},a.a.createElement(v.Text,null,"register")),a.a.createElement(v.View,null,a.a.createElement(v.Text,null))))}}]),n}(r.Component);var P=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e){var r;Object(u.a)(this,n),r=t.call(this,e);var a=function(){var e=window.localStorage.getItem("TaylorCode");return e||(e="(add (mul 2 (add 13 56)) 9000)",window.localStorage.setItem("TaylorCode",e)),e}(),s=z.a.expr2h(a);return r.state=Object(d.a)({},r.getWindowDimensions(),{pageNumber:3,autocompile:!0,code:a,encoded:s,result:[{data:s}],errors:"",provider:null,signer:null,rootAddress:null,taycall:null,taysend:null}),r.onContentSizeChange=r.onContentSizeChange.bind(Object(g.a)(r)),r.getWindowDimensions=r.getWindowDimensions.bind(Object(g.a)(r)),r.onTextChange=r.onTextChange.bind(Object(g.a)(r)),r.execute=r.execute.bind(Object(g.a)(r)),r.onRootChange=r.onRootChange.bind(Object(g.a)(r)),r.setWeb3(),r}return Object(h.a)(n,[{key:"setWeb3",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:t=e.sent,n=t.provider,r=t.signer,this.setState({provider:n,signer:r}),this.onRootChange();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRootChange",value:function(e,t){this.setState({taycall:e,taysend:t}),this.execute()}},{key:"execute",value:function(){var e=Object(l.a)(c.a.mark((function e(){var t,n,r,a,s,o,i,l,d,u=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},n=t.encdata,r=t.code,a=t.force,s=void 0!==a&&a,n=n||this.state.encoded,r=r||this.state.code,r&&r.includes("def!")){e.next=17;break}return e.prev=5,e.next=8,this.state.taycall(n);case 8:o=e.sent,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(5);case 13:try{i=z.a.decode(o)}catch(c){}this.setState({result:[{result:i,encoded:o,data:n}]}),e.next=34;break;case 17:if(!s){e.next=34;break}return d={},e.prev=19,e.next=22,this.state.taysend(n);case 22:return l=e.sent,this.setState({result:[{receipt:l}]}),e.next=26,l.wait();case 26:d=e.sent,e.next=31;break;case 29:e.prev=29,e.t1=e.catch(19);case 31:if(0!==d.status){e.next=33;break}throw new Error("Transaction failed");case 33:this.setState({result:[{receipt:d}]});case 34:case"end":return e.stop()}}),e,this,[[5,11],[19,29]])})));return function(){return e.apply(this,arguments)}}()},{key:"onContentSizeChange",value:function(){this.setState(this.getWindowDimensions())}},{key:"getWindowDimensions",value:function(){var e=m.a.get("window"),t=document.getElementById("TaylorRoot").getBoundingClientRect();return{width:e.width||t.width,height:e.height||t.height}}},{key:"editorDidMount",value:function(e,t){e.focus()}},{key:"onTextChange",value:function(e){try{var t=z.a.expr2h(e);this.setState({code:e}),n=e,window.localStorage.setItem("TaylorCode",n),this.execute({encdata:t,code:e})}catch(r){}var n}},{key:"render",value:function(){var e=this,t=this.state,n=t.width,r=t.height,s=function(e,t){var n=t.width,r=t.height;return n<800?{minWidth:n,minHeight:r}:{width:n/e,height:r}}(this.state.pageNumber,{width:n,height:r}),o=Object(d.a)({},s,{width:2*s.width,height:2*s.height/5}),i=Object(d.a)({},s,{width:2*s.width,height:s.height-o.height}),c=Object(d.a)({},s),l=this.state,u=l.code,h=l.result,g=l.errors,p=l.taycall,f=l.taysend;return a.a.createElement(b.a,{horizontal:!0,pagingEnabled:!0,scrollEnabled:!0,scrollEventThrottle:100,nestedScrollEnabled:!0,contentContainerStyle:{width:"100%"},onContentSizeChange:this.onContentSizeChange},a.a.createElement(v.View,{style:Object(d.a)({},o,{flex:1})},a.a.createElement(y.a,{width:o.width,height:o.height,language:"javascript",theme:"vs-dark",value:u,options:x,onChange:this.onTextChange,editorDidMount:this.editorDidMount}),a.a.createElement(E,{result:h,errors:g,styles:Object(d.a)({},i)})),a.a.createElement(v.Button,{small:!0,light:!0,style:{position:"fixed",top:"0px",left:"0px",backgroundColor:"white",opacity:this.state.autocompile?.5:.2},onClick:function(){return e.execute({force:!0})}},a.a.createElement(v.Icon,{type:"FontAwesome",name:"play"})),a.a.createElement(D,{taycall:p,taysend:f,styles:Object(d.a)({},c),onRootChange:this.onRootChange}))}}]),n}(r.Component);var V=function(e){return a.a.createElement(P,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(V,null),document.getElementById("TaylorRoot")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[458,1,2]]]);
//# sourceMappingURL=main.42a3af8c.chunk.js.map